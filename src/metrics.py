import pandas as pd
import numpy as np
import io

# Вставьте сюда вашу таблицу в формате TSV (новость мы пропустим, нам важны 3 последних столбца)
# Для простоты уберём сам текст новости и оставим "TrueLabels", "PredLabels" и "Score"
DATA = """
TrueLabels	PredLabels	Score
Региональный Госсектор	['IT Безопасность','Региональный Госсектор']	0.5
Без категории	['Без категории']	1
Бизнес	['Региональный Госсектор','Бизнес']	1
Региональный Госсектор	['Региональный Госсектор']	1
IT Безопасность	['IT Безопасность']	1
Без категории	['IT Безопасность','Региональный Госсектор']	0
Без категории	['Без категории']	1
Региональный Госсектор	['Без категории']	0
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
Региональный Госсектор	['Региональный Госсектор']	1
Региональный Госсектор	['Региональный Госсектор']	1
Региональный Госсектор	['Без категории','Региональный Госсектор']	1
Региональный Госсектор	['Региональный Госсектор']	1
Региональный Госсектор	['Региональный Госсектор']	1
Региональный Госсектор	['Региональный Госсектор']	1
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
IT Безопасность	['IT Безопасность','Региональный Госсектор']	1
IT Безопасность	['IT Безопасность']	1
Без категории	['IT Безопасность']	0
Бизнес	['Бизнес']	1
Региональный Госсектор	['Без категории']	0
Региональный Госсектор	['Региональный Госсектор','Бизнес']	1
Бизнес	['Региональный Госсектор','Бизнес']	1
Без категории	['Без категории']	0
"""

# Читаем данные
df = pd.read_csv(io.StringIO(DATA), sep="\t")

# Список всех меток
labels = ["IT Безопасность", "Региональный Госсектор", "Бизнес"]

# 1) Weighted Accuracy
weighted_accuracy = df["Score"].mean()

# 2) Macro‑Score
per_label = []
for lab in labels:
    mask = df["TrueLabels"] == lab
    if mask.sum() == 0:
        continue
    per_label.append(df.loc[mask, "Score"].mean())
macro_score = np.mean(per_label)

print(f"Weighted Accuracy = {weighted_accuracy:.3f}")
print(f"Macro‑Score      = {macro_score:.3f}")
